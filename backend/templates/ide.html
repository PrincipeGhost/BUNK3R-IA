<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BUNK3R IDE - Visual Studio Code</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='ide.css') }}">
    <!-- Monaco Editor -->
    <link rel="stylesheet" data-name="vs/editor/editor.main"
        href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/editor/editor.main.min.css">
    <!-- Xterm.js for Terminal -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.min.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Segoe+UI:wght@400;600&display=swap"
        rel="stylesheet">
</head>

<body class="vscode-theme">
    <!-- VS Code Top Title Bar -->
    <div class="window-titlebar">
        <div class="titlebar-left">
            <img src="https://upload.wikimedia.org/wikipedia/commons/9/9a/Visual_Studio_Code_1.35_icon.svg" width="16"
                height="16" alt="VS Code">
            <div class="menu-items">
                <span>File</span>
                <span>Edit</span>
                <span>Selection</span>
                <span>View</span>
                <span>Go</span>
                <span>Run</span>
                <span>Terminal</span>
                <span>Help</span>
            </div>
        </div>
        <div class="titlebar-center">
            <span id="active-filename">BUNK3R-IA - Visual Studio Code</span>
        </div>
        <div class="titlebar-right">
            <div class="window-controls">
                <span class="control minimize"></span>
                <span class="control maximize"></span>
                <span class="control close"></span>
            </div>
        </div>
    </div>

    <div class="main-container">
        <!-- VS Code Activity Bar (Leftmost) -->
        <div class="activity-bar">
            <div class="activity-top">
                <div class="activity-item active" data-sidebar="explorer" title="Explorer (Ctrl+Shift+E)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                    </svg>
                </div>
                <div class="activity-item" data-sidebar="search" title="Search (Ctrl+Shift+F)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                </div>
                <div class="activity-item" data-sidebar="scm" title="Source Control (Ctrl+Shift+G)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <circle cx="18" cy="5" r="3"></circle>
                        <circle cx="6" cy="12" r="3"></circle>
                        <circle cx="18" cy="19" r="3"></circle>
                        <line x1="6" y1="15" x2="6" y2="21"></line>
                        <line x1="6" y1="3" x2="6" y2="9"></line>
                        <path d="M18 8V16"></path>
                    </svg>
                </div>
                <div class="activity-item" data-sidebar="chat" title="BUNK3R AI Chat (Ctrl+Shift+I)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                </div>
            </div>
            <div class="activity-bottom">
                <div class="activity-item" id="settings-btn" title="Settings">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path
                            d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                        </path>
                    </svg>
                </div>
            </div>
        </div>

        <!-- VS Code Side Bar -->
        <div class="side-bar" id="side-bar">
            <div class="sidebar-header">
                <span id="sidebar-title">EXPLORER</span>
                <div class="sidebar-actions">
                    <button id="sync-btn" title="Sync Repos">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path
                                d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2" />
                        </svg>
                    </button>
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="1"></circle>
                        <circle cx="12" cy="5" r="1"></circle>
                        <circle cx="12" cy="19" r="1"></circle>
                    </svg>
                </div>
            </div>

            <div class="sidebar-content">
                <!-- Repo Selector -->
                <div class="sidebar-section">
                    <div class="section-header">WORKSPACE</div>
                    <select id="repo-selector" class="vscode-select">
                        <option value="">Select repository...</option>
                    </select>
                </div>

                <!-- File Tree / Chat Content / Search -->
                <div id="sidebar-view-container">
                    <div id="explorer-view" class="sidebar-view active">
                        <div id="file-tree" class="file-tree"></div>
                    </div>
                    <div id="search-view" class="sidebar-view">
                        <div class="search-container">
                            <input type="text" id="global-search-input" class="vscode-input" placeholder="Search">
                            <input type="text" id="global-replace-input" class="vscode-input" placeholder="Replace"
                                style="margin-top: 5px;">
                            <div id="search-results" class="search-results"></div>
                        </div>
                    </div>
                    <div id="scm-view" class="sidebar-view">
                        <div class="scm-container">
                            <div class="scm-commit-box">
                                <textarea id="scm-commit-message"
                                    placeholder="Message (Ctrl+Enter to commit)"></textarea>
                                <button id="scm-commit-btn" class="vscode-btn-primary">Commit</button>
                            </div>
                            <div id="scm-changes-list" class="scm-changes-list">
                                <!-- Git changes will be rendered here -->
                            </div>
                        </div>
                    </div>
                    <div id="chat-view" class="sidebar-view">
                        <div id="chat-messages" class="chat-messages"></div>
                        <div class="chat-input-wrapper">
                            <textarea id="chat-input" placeholder="Ask BUNK3R AI..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="editor-and-panel">
            <!-- VS Code Editor Area -->
            <div class="editor-container">
                <div class="editor-tabs-container">
                    <div class="editor-tabs" id="editor-tabs"></div>
                </div>
                <div id="monaco-editor" class="monaco-editor"></div>
            </div>

            <div class="horizontal-resizer" id="horizontal-resizer"></div>

            <!-- VS Code Bottom Panel (Terminal) -->
            <div class="bottom-panel" id="bottom-panel">
                <div class="panel-tabs">
                    <div class="panel-tab-item active" data-panel="terminal">TERMINAL</div>
                    <div class="panel-tab-item" data-panel="output">OUTPUT</div>
                    <div class="panel-tab-item" data-panel="problems">PROBLEMS</div>
                </div>
                <div class="panel-content">
                    <div id="terminal-container" class="terminal-container active"></div>
                    <div id="output-container" class="panel-view"></div>
                </div>
            </div>
        </div>

        <!-- Optional Preview Pane (Collapsible) -->
        <div class="preview-pane" id="preview-pane">
            <div class="panel-header">
                <span>PREVIEW</span>
                <button id="refresh-preview-btn" class="icon-btn">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2" />
                    </svg>
                </button>
            </div>
            <iframe id="preview-frame" sandbox="allow-scripts allow-same-origin"></iframe>
        </div>
    </div>

    <!-- VS Code Status Bar -->
    <div class="status-bar">
        <div class="status-left">
            <div class="status-item git-branch">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="18" cy="5" r="3"></circle>
                    <circle cx="6" cy="12" r="3"></circle>
                    <circle cx="18" cy="19" r="3"></circle>
                    <path d="M18 8V16"></path>
                    <path d="M6 15v6"></path>
                    <path d="M6 3v9"></path>
                </svg>
                <span id="git-branch-name">main*</span>
            </div>
            <div class="status-item" id="sync-status">
                <span class="status-dot"></span>
                <span class="status-text">Synchronized</span>
            </div>
        </div>
        <div class="status-right">
            <div class="status-item">Ln 1, Col 1</div>
            <div class="status-item">Spaces: 4</div>
            <div class="status-item">UTF-8</div>
            <div class="status-item notify-btn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                </svg>
            </div>
        </div>
    </div>

    <!-- Command Palette -->
    <div id="command-palette" class="palette-overlay">
        <div class="palette-container">
            <input type="text" id="palette-input" class="vscode-input" placeholder="> Type a command...">
            <div id="palette-list" class="palette-list">
                <!-- Items populated by JS -->
            </div>
        </div>
    </div>

    <!-- Modals & Overlays -->
    <div id="settings-modal" class="vscode-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>GitHub Settings</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p>Personal Access Token:</p>
                <input type="password" id="github-token-input" placeholder="ghp_xxxxxxxxxxxx" class="vscode-input">
            </div>
            <div class="modal-footer">
                <button id="save-token-btn" class="vscode-btn-primary">Save Changes</button>
            </div>
        </div>
    </div>

    <div id="loading-overlay" class="loading-overlay">
        <div class="spinner"></div>
        <p id="loading-text">Loading Workspace...</p>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xterm-addon-fit@0.8.0/lib/xterm-addon-fit.min.js"></script>
    <script src="{{ url_for('static', filename='ide.js') }}"></script>
</body>

</html>